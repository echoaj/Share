# Load WSUS module
[void][reflection.assembly]::LoadWithPartialName("Microsoft.UpdateServices.Administration")

# Connect to the WSUS server
$wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::GetUpdateServer("WSUSServerName", $False, 8530)

# Get all approved updates
$approvedUpdates = $wsus.GetUpdates() | Where-Object { $_.GetUpdateApprovals() -ne $null }

# Output the details of approved updates
$approvedUpdates | ForEach-Object {
    $update = $_
    $kb = $update.KnowledgebaseArticles
    $approvalDate = $update.GetUpdateApprovals() | Select-Object -ExpandProperty CreationDate

    [PSCustomObject]@{
        Title         = $update.Title
        KB            = $kb -join ", "
        ApprovalDate  = $approvalDate
    }
} | Format-Table -AutoSize