
Gitlab CI File
variables:
  EXPORT_LOCATION: '\\10.10.21.84\share\vm-templates\B-Team\Windows\b-cots-wsus-win19\4.1.2\20240529-133328'     # Change

stages:
  - export

export-patches: 
  stage: export
  tags:
    - strk-wsusgitlabagent01-rh84

  script: 
    # Exit immediately if a bash command fails and start ansible
    - |
      set -e
      source ~/.pyenv/ansible39/bin/activate
      ansible --version
    
    # Run ansible
    - |
      ansible-playbook -i inventory playbook.yml --extra-vars "user=$DSO_SERVICE_ACCOUNT_USR pass=$DSO_SERVICE_ACCOUNT_PSW path=$EXPORT_LOCATION"

ansilbe yaml file
- name: "Execute the patch-export script"
  win_shell: |
    powershell.exe -ExecutionPolicy Bypass -File C:\scripts\patch-export.ps1 {{ user }} {{ pass }} {{ path }}
  register: ps_output

patch-export.ps1
$path_base = $args[2]
$parsed = $path_base -split '\\'
$vm_name = $parsed[7]
$vm_version = $parsed[8]

Write-Host "Path: $path_base"
Write-Host "VM Name: $vm_name"
Write-Host "VM Vers: $vm_version"

The output of path_base is \\10.10.21.84\share
The output of vm_name and vm_version is nothing
What am I doing wrong here?
