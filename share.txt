
import winrm

# Replace these values with your actual server credentials and IP
host = "http://<windows-ip>:5985/wsman"
username = "your_username"
password = "your_password"

# Establish session
session = winrm.Session(host, auth=(username, password))

# Run PowerShell command to create a text file
command = "New-Item -Path C:\\testfile.txt -ItemType File"
result = session.run_ps(command)

# Print the output
if result.status_code == 0:
    print("Command executed successfully")
    print(result.std_out.decode())
else:
    print(f"Error: {result.status_code}")
    print(result.std_err.decode())