- CRITICAL_OUTPUT=$(FPRUtility -information -project $CI_PROJECT_DIR/target/fortify/*.fpr -search -query "[fortify priority order]:critical")
    - HIGH_OUTPUT=$(FPRUtility -information -project $CI_PROJECT_DIR/target/fortify/*.fpr -search -query "[fortify priority order]:high")
    - MEDIUM_OUTPUT=$(FPRUtility -information -project $CI_PROJECT_DIR/target/fortify/*.fpr -search -query "[fortify priority order]:medium")
    - LOW_OUTPUT=$(FPRUtility -information -project $CI_PROJECT_DIR/target/fortify/*.fpr -search -query "[fortify priority order]:low")

    # Convert the output to 0 if "No issues matched search query" else take the output as it is.
    - CRITICAL_COUNT=$( [ "$CRITICAL_OUTPUT" == "No issues matched search query." ] && echo 0 || echo $CRITICAL_OUTPUT )
    - HIGH_COUNT=$( [ "$HIGH_OUTPUT" == "No issues matched search query." ] && echo 0 || echo $HIGH_OUTPUT )
    - MEDIUM_COUNT=$( [ "$MEDIUM_OUTPUT" == "No issues matched search query." ] && echo 0 || echo $MEDIUM_OUTPUT )
    - LOW_COUNT=$( [ "$LOW_OUTPUT" == "No issues matched search query." ] && echo 0 || echo $LOW_OUTPUT )
    
    - echo "Critical vulnerabilities found: $CRITICAL_COUNT"
    - echo "High vulnerabilities found: $HIGH_COUNT"
    - echo "Medium vulnerabilities found: $MEDIUM_COUNT"
    - echo "Low vulnerabilities found: $LOW_COUNT"
    
    - if [ $CRITICAL_COUNT -gt 0 ] || [ $HIGH_COUNT -gt 0 ] || [ $MEDIUM_COUNT -gt 0 ]; then
        echo "Failing the pipeline due to detected vulnerabilities."
        exit 1
      fi
