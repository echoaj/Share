  always:
    - name: Check if C:\Directory exists
      ansible.windows.win_stat:
        path: C:\Directory
      register: dir_check

    - name: Reset permissions on C:\Directory for Administrator (if exists)
      ansible.windows.win_acl:
        path: C:\Directory
        user: Administrators
        rights: FullControl
        type: allow
        state: present
      when: dir_check.stat.exists

    - name: Remove C:\Directory (if exists)
      ansible.windows.win_file:
        path: C:\Directory
        state: absent
      when: dir_check.stat.exists